include ../mixins/containers.pug
include ../mixins/containers_aph.pug

- var imgAssets = '../assets/physics_engines/';
- var defaultBgr = 'backgrounds/physics.jpg';

+mchapter('Physics Engine', imgAssets+'chapter_physics.svg')
+frameInbox('Physics engine')
	.important-green
		.bottom-0.right-0
			img.height-400(src=imgAssets+'physics_01.png')
		ul
			li.fragment system that <span class="highlight">approximates</span> physical phenomena in real-time
			li.mt-40.upside.fragment can improve immersion
			li.downside.fragment can broke the game story
			li.fragment.highlight Flow
				.bottom-40.left-220
					img.height-500(src=imgAssets+'physics_flow.svg')
+frameInbox('Physics and animation')
	.important-green
		ul
			li.highlight.fragment(data-fragment-index='1') physics 
				include ../../assets/physics_engines/equations_generated/animation.svg
				|&nbsp;animation!
			li.fragment(data-fragment-index='2') animations must cooperate with physics engine to run seamlessly
			li.fragment(data-fragment-index='3') cut-scenes and state-transition animations are detached from physics
			li.fragment(data-fragment-index='5') almost all AAA games still use static animations connected to the physical environment
		.space-xl
		.flex-cols-3.ml-100.fragment(data-fragment-index='1')
			div.text-center
				img.height-280(src=imgAssets+'animation.gif')
			div.text-center
				img.height-280(src=imgAssets+'animation02.gif')
			div
				img.height-280(src=imgAssets+'animation03.gif')
+frameInbox('Physics in games')
	div
		.scope.fragment(data-fragment-index='1')
			p Pinballs (1980+)
			ul
				li non-trivial OBB collision detection
		.scope.fragment(data-fragment-index='2')
			p The Incredible Machine (1993)
			ul
				li advanced physical interactions
		.scope.fragment(data-fragment-index='3')
			p Worms (1995)
			ul
				li pixel-level environment interaction
		.scope.fragment(data-fragment-index='4')
			p Half-Life 2 (2004)
			ul
				li destructible environment, liquid physics
		.top-20.right-20.fragment(data-fragment-index='1')
			img.height-300(src=imgAssets+'pinball.gif')
		.top-170.right-430.fragment(data-fragment-index='2')
			img.height-300(src=imgAssets+'incredible_machine.png')
		.top-280.right-20.fragment(data-fragment-index='3')
			img.height-350(src=imgAssets+'worms.png')
		.bottom-0.right-370.fragment(data-fragment-index='4')
			img.height-400(src=imgAssets+'half-life2.jpg')
+frameInbox('Physics in games')
	div.spacing-3xs
		.scope.fragment(data-fragment-index='0')
			p World of Goo (2008)
			ul
				li fyzika jako hlavn√≠ mechanika
		.scope.fragment(data-fragment-index='1')
			p Angry Birds (2009)
			ul
				li physics as the core mechanic
		.scope.fragment(data-fragment-index='2')
			p INSIDE (2016)
			ul
				li soft-bodies driven by a network of impulses
		.scope.fragment(data-fragment-index='3')
			p Half-Life Alyx (2020)
			ul
				li physics-based interactions
		.scope.fragment(data-fragment-index='4')
			p Noita (2020)
			ul
				li pixel-level physics simulation
		.top-20.right-20.fragment(data-fragment-index='0')
			img.height-400(src=imgAssets+'goo.jpg')
		.top-170.right-370.fragment(data-fragment-index='1')
			img.height-400(src=imgAssets+'angry_birds.png')
		.top-340.right-20.fragment(data-fragment-index='2')
			img.height-280(src=imgAssets+'inside.gif')
		.bottom-0.right-20.fragment(data-fragment-index='3')
			img.height-300(src=imgAssets+'half-life-alyx.jpg')
		.bottom-0.right-570.fragment(data-fragment-index='4')
			img.height-350(src=imgAssets+'noita.jpg')
+frameInbox('Object types')
	.important-orange.spacing-3xs
		.scope.fragment
			p Body
			ul
				li.fragment fundamental object in the physics scene
		.scope.fragment
			p Rigid Body
			ul
				li.fragment idealized, infinitely hard, non-deformable solid object
				li.fragment <span class="highlight-2">physics-driven bodies</span> - driven entirely by the simulation
				li.fragment <span class="highlight-2">game-driven bodies</span> - moved in a non-physical way (animations)
				li.fragment <span class="highlight-2">fixed bodies</span> - collision-only bodies (e.g. triggers)
		.scope.fragment
			p Soft body
			ul
				li.fragment deformable
		.scope.fragment
			p Shape
			ul
				li.fragment curved line, polygon, curved surface, polyhedron
		.scope.fragment
			p Fixture
			ul
				li.fragment used to describe size, shape and material properties
		.right-50.top-250
			img.height-350(src=imgAssets+'cube.png')
+frameInbox('Object Types')
	.important-orange
		.scope.fragment
			p Constraint
			ul
				li.fragment connects bodies together in order to simulate interaction (ropes, wheels, vehicles, chains)
		.scope.fragment
			p Sensor/Phantom
			ul
				li.fragment entity that provides a feedback when certain objects overlap
				li.fragment participates on collision detection but doesn't affect the scene
		.scope.fragment
			p Rag doll
			ul
				li.fragment displays human-like figures with a realistic motion
		.scope.fragment
			p Destructible object
			ul
				li.fragment breakable object, can be implemented by using rigid body dynamics, dividing the model into a number of breakable pieces
+frameInbox('Constraints')
	.important-green
		ul
			li.fragment <span class="highlight">Revolute</span> - a hinge or pin, where the bodies rotate
				ul
					li.fragment wheels, chains, rotating doors, catapults, levers
			li.fragment <span class="highlight">Distance</span> - a point on each body will be kept at a fixed distance apart
			li.fragment <span class="highlight">Rope</span> - restricts the maximum distance between two points
			li.fragment <span class="highlight">Prismatic</span> - body's motion is restricted to a single degree of freedom
				ul
					li.fragment elevators and pistons
			li.fragment <span class="highlight">Weld</span> - holds the bodies at the same orientation
			li.fragment <span class="highlight">Cone-Twist</span> - adds a cone and twist axis limits (6 degrees of freedom)
			li.fragment <span class="highlight">Gear</span> - controls two other joints so that the movement of one affects the other
			li.fragment <span class="highlight">Motor</span> - joint with torque or angular impulses
		.bottom-0.right-460
			img.height-230(src=imgAssets+'car.svg')
+frameInbox('Constraints')
	.important-orange
	.flex.flex-row.justify-evenly.center
		figure.fragment
			img.height-500(src=imgAssets+'constraint_rope.svg')
			p rope
		figure.fragment
			img.height-500(src=imgAssets+'constraint_revolute.svg')
			p revolute
		figure.fragment
			img.height-500(src=imgAssets+'constraint_prismatic.svg')
			p prismatic
		figure.fragment
			img.height-500(src=imgAssets+'constraint_conetwist.svg')
			p cone-twist
+frameInbox('Constraints')
	div
		.top-170.left-350
			img.height-680(src=imgAssets+'joints.jpg')
		.top-130.left-10
			img.height-580(src=imgAssets+'constraints.svg')
+frameInbox('Fracturing')
	div
		ul
			li.fragment breaking an object into smaller fragments
			li.fragment in many cases destruction is not dynamic (can be made using animations)
			li.fragment techniques: manual fracturing, Voronoi Shattering, voxels
		.bottom-0.right-0.width-100p
			img.width-100p.radius-3(src=imgAssets+'fracturing.png')
		.bottom-150.flex.flex-row
			figure.mx-10.fragment
				img.height-310(src=imgAssets+'paratrooper.png')
				p.bgr-rhino-100.p-5 Paratrooper (1982)
			figure.mx-10.fragment
				img.height-310(src=imgAssets+'fictorium.jpg')
				p.bgr-rhino-100.p-5 Fictorium (2017)
			figure.mx-10.fragment
				img.height-310(src=imgAssets+'teardown.jpg')
				p.bgr-rhino-100.p-5 Teardown (2020)
+frameInbox('Particle Systems')
	.important-orange
		ul
			li.fragment a collection of point masses that obeys certain physical laws
			li.fragment can model complex shapes and dynamics
			li.fragment uses Flyweight pattern (array of positions, velocities, group lists)
		.scope.fragment.mt-30
			p Applications
			ul.leading-md
				li.highlight-2.fragment fluids
				li.fragment visual effects
				li.fragment flocks
				li.fragment rendered trails (plants)
				li.fragment soft bodies (flag, cloth)
		.right-20.bottom-150
			img.height-400(src=imgAssets+'particles.gif')
		.right-350.bottom-150
			img.height-400(src=imgAssets+'flame.gif')
+frameInbox('Example: CryEngine Fluid Physics')
	div
		ul
			li.fragment 5000+ lines of code for just the RigidBody part
			li.fragment very poor code quality
				.code.text-xs.mt-20
					include ../../assets/physics_engines/snippets_generated/cryengine.html
		.bottom-20.right-20
			img.height-770(src=imgAssets+'cryengine_physics.png')