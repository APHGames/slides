include ../mixins/containers.pug
include ../mixins/containers_aph.pug

- var imgAssets = '../assets/graphics_processing/';
- var defaultBgr = 'backgrounds/gpu.jpg';

+mchapter('Grafické karty', imgAssets+'chapter_gpu.svg')
+frameInbox('Historie GPU')
	div
		.bottom-20.right-40
			img.height-800(src=imgAssets+'history.svg')
		.bottom-40.right-40
			img.height-780(src=imgAssets+'history.png')
+frameInbox('Historie GPU')
	div
		ul.spacing-md
			li.fragment(data-fragment-index='1') <span class="highlight">1981</span> - <span class="highlight-2">IBM MDA</span>, Monochrome Display Adapter
			li.fragment(data-fragment-index='2') <span class="highlight">1982</span> - <span class="highlight-2">IBM CGA</span>, Color Graphics Adapter, 4/16 barev
			li.fragment(data-fragment-index='3') <span class="highlight">1984</span> - <span class="highlight-2">IBM EGA</span>, Enhanced Graphics Adapter, 16/64 barev
			li.fragment(data-fragment-index='4') <span class="highlight">1987</span> - <span class="highlight-2">VGA</span> - Video Graphics Array, 256 barev
			li.fragment(data-fragment-index='5') <span class="highlight">1994</span> - <span class="highlight-2">S3 Trio64</span> - zlatá éra DOS her
			li.fragment(data-fragment-index='6') <span class="highlight">1996</span> - <span class="highlight-2">3dfx Voodoo</span> - vzestup 3D akcelerátorů
			li.fragment(data-fragment-index='7') <span class="highlight">1999</span> - <span class="highlight-2">Geforce 256</span> - renderovací pipeline
			li.fragment(data-fragment-index='8') <span class="highlight">2003</span> - <span class="highlight-2">Geforce 3</span> - nástup shaderů
			li.fragment(data-fragment-index='9') <span class="highlight">2006</span> - <span class="highlight-2">Geforce 8</span> - SM architektura, CUDA
			li.fragment(data-fragment-index='10') <span class="highlight">2016</span> - <span class="highlight-2">Oculus Rift</span> - VR headsety
			li.fragment(data-fragment-index='11') <span class="highlight">2018</span> - <span class="highlight-2">Geforce 10</span> - Tensor core a Raytracing
		.top-0.right-50.fragment(data-fragment-index='2')
			img.height-250(src=imgAssets+'history_cga.png')
		.top-180.right-150.fragment(data-fragment-index='3')
			img.height-250(src=imgAssets+'history_ega.png')
		.top-300.right-400.fragment(data-fragment-index='4')
			img.height-250(src=imgAssets+'history_vga.png')
		.top-400.right-30.fragment(data-fragment-index='5')
			img.height-250(src=imgAssets+'history_svga.jpg')
		.top-500.right-380.fragment(data-fragment-index='6')
			img.height-250(src=imgAssets+'history_glquake.jpg')
		.top-650.right-40.fragment(data-fragment-index='11')
			img.height-250(src=imgAssets+'history_turing.jpg')
		.tip.fragment.bottom-140.right-300(data-fragment-index='12')
			img.height-550(src=imgAssets+'meme_4090.png')
+frameInbox('Grafické API')
	div.spacing-3xs
		.scope.fragment
			p DirectX
			ul
				li.fragment od roku 1995
				li.fragment především pro Windows a Xbox hry
				li.fragment současná verze DirectX 12 Ultimate
			.top-80.right-60
				img.width-300(src=imgAssets+'logo_directx.png')
		.scope.fragment
			p OpenGL
			ul
				li.fragment od roku 1992
				li.fragment koncept stavového automatu
				li.fragment multi-platformní
				li.fragment OpenGL ES - odnož pro Android, iOS
			.top-460.right-60
				img.width-300(src=imgAssets+'logo_opengl.png')
		.scope.fragment
			p Vulkan
			ul
				li.fragment od roku 2015
				li.fragment prezentován jako OpenGL nové generace
				li.fragment nabízí větší kontrolu nad GPU oproti OpenGL
			.top-760.right-60
				img.width-300(src=imgAssets+'logo_vulkan.png')
+frameInbox('Renderovací pipeline')
	.important-green
		ul.fragment.spacing-xs
			li.fragment <span class="highlight">Vertex Fetch</span>: ovladač vloží data do pushbufferu
			li.fragment <span class="highlight">Poly Morph Engine</span> v SM načte vertexy
			li.fragment spustí se warp vláken v SM
			li.fragment spustí se Vertex shadery
			li.fragment spustí se H/D/G shadery (nepovinně)
			li.fragment <span class="highlight">Pixel(fragment) shader</span> vygeneruje informaci o pixelu
			li.fragment data se pošlou do <span class="highlight">ROP</span> (Render Output Unit)
			li.fragment ROP spustí hloubkový test, antialiasing a vykreslí pixel
			.text-center.mt-20
				img.height-320(src=imgAssets+'gpu_process.svg')
+frameInbox('Renderovací pipeline')
	.center.fill
		img.height-250(src=imgAssets+'pipeline_example.svg')
+frameInbox('Shadery')
	.important-orange.spacing-xs
		ul
			li.fragment programy, které jsou spouštěny na GPU a aplikují efekty nad grafickými elementy (osvětlení, efekty, post-processing, fyzika, AI)
		.scope.fragment
			p Vertex shader
			ul
				li.fragment vstupem je vertex, výstupem je transformovaný vertex
		.scope.fragment
			p Geometry shader (nepovinný)
			ul
				li.fragment vstupem je primitivum, výstupem je 0-n primitiv
		.scope.fragment
			p Teselační shader (nepovinný)
			ul
				li.fragment vstupem je primitivum, výstupem je rozdělené primitivum
		.scope.fragment
			p Pixel (fragment) shader
			ul
				li.fragment vstupem je fragment, výstupem je barva a další hodnoty
				li.fragment používá se především pro vizuální efekty
			.bottom-50.right-50
				figure
					img.height-500(src=imgAssets+'asciident.jpg')
					p ASCIIdent
		.scope.fragment
			p Compute shader
			ul
				li.fragment shader který běží mimo renderovací pipelie (např. CUDA)
+frameInbox('Aplikace shaderů')
	div.spacing-2xs
		.scope.fragment
			p Vertex shader
			ul
				li.fragment 3D-2D transformace
				li.fragment displacement mapping
				li.fragment skinning
		.scope.fragment
			p Teselační shader
			ul
				li.fragment Hull Shader - tessellation control
				li.fragment Domain Shader - tessellation evaluation
			.top-40.right-40
				figure
					img.height-200(src=imgAssets+'tessellation.jpg')
					p Teselace povrchu
		.scope.fragment
			p Geometry shader
			ul
				li.fragment bod-sprite konverze
				li.fragment particle systémy
			.top-300.right-40
				figure
					img.height-250(src=imgAssets+'geom_shader.gif')
					p Tráva
		.scope.fragment
			p Pixel (fragment) shader
			ul
				li.fragment bump mapping
				li.fragment particle systémy
				li.fragment vizuální efekty
			.bottom-0.right-40
				figure
					img.height-250(src=imgAssets+'screen_shader.gif')
					p Screen Effect
+frameInbox('Příklad: Geometry shader')
	div
		.code.text-2xs
			include ../../assets/graphics_processing/snippets_generated/geom.html
	.top-40.right-40
		img.height-300(src=imgAssets+'geom_shader.svg')